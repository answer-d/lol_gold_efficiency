{% extends "gold_efficiency/base.html" %}

{% load i18n static %}

{% block title %}アイテム一覧{% endblock title %}

{% block extra_css %}
<link rel="stylesheet" type="text/css" href="{% static 'gold_efficiency/css/datatables.min.css' %}" />
{% endblock extra_css %}

{% block content %}
<nav class="navbar sticky-top navbar-light" style="background-color: #e3f2fd;">
    <a class="navbar-brand" href="#">Gold Efficiency</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#goldefficiencyNav" aria-controls="goldefficiencyNav"
            area-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="goldefficiencyNav">
        <a class="nav-item nav-link active" href="#">Home</a>
        <a class="nav-item nav-link" href="#">List</a>
    </div>
</nav>

<br />

{% if item_list %}
    <div class="table-responsive">
        <!--<table class="table table-hover">-->
        <table class="table" id="itemtable">
        <caption>patch {{ patch_version.version_str }}</caption>
        <thead class="thead-dark">
            <tr>
                <th scope="col">アイテム</th>
                <th scope="col">合計金額 (G)</th>
                <th scope="col">金銭価値 (G)</th>
                <th scope="col">金銭効率 (%)</th>
                <th scope="col">素材</th>
                <th scope="col">合成先</th>
                <th scope="col">詳細</th>
                <th scope="col">Tier</th>
            </tr>
        </thead>
        <tbody>
        {% for item in item_list %}
            <tr>
                <td>
                    <div class="card border-0">
                        <img class="card-img-top" src="{{ item.img }}" alt="item_image">
                        <div class="card-body">
                            <h6 class="card-title">{{ item.name }}</h6>
                        </div>
                    </div>
                </td>
                <td>{{ item.total_cost }}</td>
                <td>{{ item.gold_value }}</td>
                <td>{{ item.gold_efficiency }}</td>
                <td>
                    <div class="card-group">
                        {% for from_item in item.from_items %}
                            <div class="card border-0">
                                <img class="card-img-top" src="{{ from_item.img }}" alt="{{ from_item.name }}">
                            </div>
                        {% endfor %}
                    </div>
                </td>
                <td>
                    <div class="card-group">
                        {% for into_item in item.into_items %}
                            <div class="card border-0">
                                <img class="card-img-top" src="{{ into_item.img }}" alt="{{ into_item.name }}">
                            </div>
                        {% endfor %}
                    </div>
                </td>
                <td>
                    {% for s in item.stats %}
                        <dl class="row">
                            <dd class="col-sm-10">{{ s.amount }} {{ s.name }}</dd>
                            <dd class="col-sm-2">{{ s.gold_value }}</dd>
                        </dl>
                    {% endfor %}
                    {% for e in item.effects %}
                        <dl class="row">
                            {% if e.gold_value %}
                                <dd class="col-sm-10">{{ e.description }}</dd>
                                <dd class="col-sm-2">{{ e.gold_value }}</dd>
                            {% else %}
                                <dd class="col-sm-10"><mark>{{ e.description }}</mark></dd>
                                <dd class="col-sm-2"><span class="badge badge-secondary">評価不可</span></dd>
                            {% endif %}
                        </dl>
                    {% endfor %}
                </td>
                <td>{{ item.depth }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    </div>
{% else %}
    <p>No Items are available.</p>
{% endif %}
{% endblock content %}

{% block extra_js %}
<script type="text/javascript" src="{% static 'gold_efficiency/js/datatables.min.js' %}"></script>
<script type="text/javascript">
    $(document).ready(function() {
        $('#itemtable').DataTable({
            "language": {
                "url": "//cdn.datatables.net/plug-ins/1.10.16/i18n/Japanese.json",
            },
            "paging": false,
            "aoColumnDefs": [
                // { "bSearchable": false, "aTargets": [ 1, 2, 3, 4 ] },
                { "bSortable": false, "aTargets": [ 4, 5, 6 ] },
                // { "bVisible":false, "aTargets": [  ] },
            ],
        });
    });
</script>
{% endblock extra_js %}
