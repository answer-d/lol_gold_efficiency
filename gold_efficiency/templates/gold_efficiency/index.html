{% extends "gold_efficiency/base.html" %}

{% load i18n static %}

{% block title %}アイテム一覧{% endblock title %}

{% block extra_css %}
<!-- <link rel="stylesheet" type="text/css" href="{% static 'gold_efficiency/css/datatables.min.css' %}" /> -->
<link rel="stylesheet" type="text/css" href="{% static 'gold_efficiency/css/index.css' %}" />
{% endblock extra_css %}

{% block content %}
{% if item_list %}
    <!-- <table class="table table-responsive" id="itemtable">
    <caption>patch {{ patch_version.version_str }}</caption>
    <thead class="thead-dark">
        <tr>
            <th>アイテム</th>
            <th>合計金額 (G)</th>
            <th>金銭価値 (G)</th>
            <th>金銭効率 (%)</th>
            <th>素材</th>
            <th>合成先</th>
            <th>詳細</th>
            <th>Tier</th>
        </tr>
    </thead>
    <tbody> -->
    <div class="card-columns">
      {% for item in item_list %}
          <div class="card bg-light mb-3">
            <div class="card-header">{{ item.name }}</div>
            <div class="d-flex">
              <div>
                <div class="itemicon">
                  <img src="{{ item.img }}" alt="{{ item.name }}" class="img-fluid rounded-circle" />
                  <p class="font-weight-bold text-light">{{ item.get_gold_efficiency|floatformat }}%</p>
                </div>
                <div class="card-body">
                  <p class="card-text">Total: {{ item.total_cost }}</p>
                  <p class="card-text">Value: {{ item.get_gold_value|floatformat }}</p>
                </div>
              </div>
              <div>
                {% for e in item.effect_set.all %}
                  <p class="card-text">{{ e.description }}</p>
                  {% if e.is_evaluable %}
                      <p class="card-text">{{ e.get_gold_value|floatformat }}</p>
                  {% else %}
                      <p class="card-text"><span class="badge badge-secondary">評価不可</span></p>
                  {% endif %}
                {% endfor %}
                <p class="card-text">{{ item.depth }}</p>
              </div>
            </div>
          </div>
      {% endfor %}
    </div>
          <!-- <tr>
              <td>
                  <img src="{{ item.img }}" alt="{{ item.name }}" class="img-fluid rounded-circle" />
                  <br>{{ item.name }}
              </td>
              <td>{{ item.total_cost }}</td>
              <td>{{ item.get_gold_value|floatformat }}</td>
              <td>{{ item.get_gold_efficiency|floatformat }}%</td>
              <td>
                  {% for from_item in item.from_items %}
                      <img src="{{ from_item.img }}" alt="{{ from_item.name }}" class="img-fluid rounded" />
                  {% endfor %}
              </td>
              <td>
                  {% for into_item in item.into_items %}
                      <img src="{{ into_item.img }}" alt="{{ into_item.name }}" class="img-fluid rounded" />
                  {% endfor %}
              </td>
              <td>
                  {% for e in item.effect_set.all %}
                      <dl class="row">
                          <dd class="col-8">{{ e.description }}</dd>
                          {% if e.is_evaluable %}
                              <dd class="col-4">{{ e.get_gold_value|floatformat }}</dd>
                          {% else %}
                              <dd class="col-4"><span class="badge badge-secondary">評価不可</span></dd>
                          {% endif %}
                      </dl>
                  {% endfor %}
              </td>
              <td>{{ item.depth }}</td>
          </tr> -->
    <!-- </tbody>
    </table> -->
{% else %}
    <p>No Items are available.</p>
{% endif %}
{% endblock content %}

{% block extra_js %}
<script type="text/javascript" src="{% static 'gold_efficiency/js/datatables.min.js' %}"></script>
<script type="text/javascript">
    $(document).ready(function() {
        $('#itemtable').DataTable({
            "language": {
                "url": "//cdn.datatables.net/plug-ins/1.10.16/i18n/Japanese.json",
            },
            "aoColumnDefs": [
                // { "bSearchable": false, "aTargets": [ 1, 2, 3, 4 ] },
                { "bSortable": false, "aTargets": [ 4, 5, 6 ] },
                // { "bVisible":false, "aTargets": [  ] },
            ],
        });
    });
</script>
{% endblock extra_js %}
